{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\u200b\\-]"},"docs":[{"location":"","text":"F5 CIS-C \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 F5 CIS-C\uff08Container Ingress Service for China Market, \u955c\u50cf\u540d\u79f0\uff1ak8s-bigip-ctlr-c\uff09\u662f\u4e00\u6b3e\u5c06Kubernetes\u96c6\u7fa4\u5185\u670d\u52a1\u901a\u8fc7F5 BIG-IP\u8fdb\u884c\u81ea\u52a8\u5316\u53d1\u5e03\u7684\u63a7\u5236\u5668\u8f6f\u4ef6\u3002\u5e2e\u52a9\u7528\u6237\u6253\u901aKubernetes\u96c6\u7fa4\u4e0e\u5916\u90e8\u5165\u53e3\uff0c\u5c06BIG-IP\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u96c6\u6210\u5230kubernetes\u6280\u672f\u6808\u7684\u4e91\u73af\u5883\u4e2d\u3002\u5b83\u5b9e\u73b0\u4e86\u591a\u56e2\u961f\u5408\u4f5c\uff0c\u5ba2\u6237\u53ef\u4ee5\u7075\u6d3b\u7684\u3001\u81ea\u52a8\u5316\u7684\u521b\u5efa\u3001\u53d8\u66f4\u5e94\u7528\u6216\u8005\u670d\u52a1\u5165\u53e3\u7b56\u7565\uff0c\u53ef\u6709\u6548\u4fc3\u8fdb\u4f01\u4e1a\u4e91\u539f\u751f\u67b6\u6784\u8f6c\u578b\u3002 F5 CIS-C\u4e2d\u7684 -C \u4ee3\u8868\u9762\u5411\u4e2d\u56fd\u5e02\u573a\uff0c\u4ee3\u8868\u53ef\u5b9a\u5236\u3002\u5b83\u4e5f\u662fF5 CIS \uff08\u5168\u7403\u65b9\u6848\uff09 \u7684\u6027\u80fd\u589e\u5f3a\u7248\u672c\u3002 \u5173\u4e8e\u4ea7\u54c1\u7684\u4efb\u4f55\u5efa\u8bae\u4e0e\u95ee\u9898\uff0c\u8bf7 \u8054\u7cfb\u6211\u4eec \u3002 \u70b9\u51fb \u8fd9\u91cc \u7acb\u5373\u67e5\u770b\u6700\u65b0\u7248\u672c\u53d1\u5e03","title":"\u4e3b\u9875"},{"location":"#f5-cis-c","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 F5 CIS-C\uff08Container Ingress Service for China Market, \u955c\u50cf\u540d\u79f0\uff1ak8s-bigip-ctlr-c\uff09\u662f\u4e00\u6b3e\u5c06Kubernetes\u96c6\u7fa4\u5185\u670d\u52a1\u901a\u8fc7F5 BIG-IP\u8fdb\u884c\u81ea\u52a8\u5316\u53d1\u5e03\u7684\u63a7\u5236\u5668\u8f6f\u4ef6\u3002\u5e2e\u52a9\u7528\u6237\u6253\u901aKubernetes\u96c6\u7fa4\u4e0e\u5916\u90e8\u5165\u53e3\uff0c\u5c06BIG-IP\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u96c6\u6210\u5230kubernetes\u6280\u672f\u6808\u7684\u4e91\u73af\u5883\u4e2d\u3002\u5b83\u5b9e\u73b0\u4e86\u591a\u56e2\u961f\u5408\u4f5c\uff0c\u5ba2\u6237\u53ef\u4ee5\u7075\u6d3b\u7684\u3001\u81ea\u52a8\u5316\u7684\u521b\u5efa\u3001\u53d8\u66f4\u5e94\u7528\u6216\u8005\u670d\u52a1\u5165\u53e3\u7b56\u7565\uff0c\u53ef\u6709\u6548\u4fc3\u8fdb\u4f01\u4e1a\u4e91\u539f\u751f\u67b6\u6784\u8f6c\u578b\u3002 F5 CIS-C\u4e2d\u7684 -C \u4ee3\u8868\u9762\u5411\u4e2d\u56fd\u5e02\u573a\uff0c\u4ee3\u8868\u53ef\u5b9a\u5236\u3002\u5b83\u4e5f\u662fF5 CIS \uff08\u5168\u7403\u65b9\u6848\uff09 \u7684\u6027\u80fd\u589e\u5f3a\u7248\u672c\u3002 \u5173\u4e8e\u4ea7\u54c1\u7684\u4efb\u4f55\u5efa\u8bae\u4e0e\u95ee\u9898\uff0c\u8bf7 \u8054\u7cfb\u6211\u4eec \u3002 \u70b9\u51fb \u8fd9\u91cc \u7acb\u5373\u67e5\u770b\u6700\u65b0\u7248\u672c\u53d1\u5e03","title":"F5 CIS-C"},{"location":"Architecture/","text":"\u4ea7\u54c1\u67b6\u6784\u4ecb\u7ecd \u00b6 F5 CIS-C\u7a0b\u5e8f\u76d1\u63a7K8s\u4e2dConfigmap\uff08\u5305\u542bAS3\u6a21\u677f\u683c\u5f0f\u7684\u4ea4\u4ed8\u914d\u7f6e\uff09\u548cEndpoints\u8d44\u6e90\uff08\u5305\u542b\u5ba2\u6237\u5e94\u7528\u670d\u52a1\u4fe1\u606f\uff09\uff0c\u5c06\u5176\u8f6c\u6362\u5e76\u4e0b\u53d1\u4e3aBIG-IP\u4e0a\u7684\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u3002\u4e4b\u540e\uff0cBIG-IP\u4f5c\u4e3a\u5ba2\u6237\u7684\u5e94\u7528\u670d\u52a1\u5165\u53e3\uff0c\u63d0\u4f9bL4-L7\u7684\u4e1a\u52a1\u53ca\u6d41\u91cf\u7684\u7ba1\u63a7\u3002 \u5de5\u4f5c\u6a21\u578b\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u6240\u91c7\u7528\u7684\u6280\u672f\u6808\u5305\u62ec\uff1a","title":"\u6574\u4f53\u67b6\u6784"},{"location":"Architecture/#_1","text":"F5 CIS-C\u7a0b\u5e8f\u76d1\u63a7K8s\u4e2dConfigmap\uff08\u5305\u542bAS3\u6a21\u677f\u683c\u5f0f\u7684\u4ea4\u4ed8\u914d\u7f6e\uff09\u548cEndpoints\u8d44\u6e90\uff08\u5305\u542b\u5ba2\u6237\u5e94\u7528\u670d\u52a1\u4fe1\u606f\uff09\uff0c\u5c06\u5176\u8f6c\u6362\u5e76\u4e0b\u53d1\u4e3aBIG-IP\u4e0a\u7684\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u3002\u4e4b\u540e\uff0cBIG-IP\u4f5c\u4e3a\u5ba2\u6237\u7684\u5e94\u7528\u670d\u52a1\u5165\u53e3\uff0c\u63d0\u4f9bL4-L7\u7684\u4e1a\u52a1\u53ca\u6d41\u91cf\u7684\u7ba1\u63a7\u3002 \u5de5\u4f5c\u6a21\u578b\u5982\u4e0b\u56fe\u6240\u793a\uff1a \u6240\u91c7\u7528\u7684\u6280\u672f\u6808\u5305\u62ec\uff1a","title":"\u4ea7\u54c1\u67b6\u6784\u4ecb\u7ecd"},{"location":"Architecture/as3/","text":"AS3\u5185\u5bb9\u914d\u7f6e\u6307\u5f15 \u00b6 TODO\uff1a\u6b63\u5728\u5b8c\u5584\u4e2d","title":"AS3\u53c2\u8003"},{"location":"Architecture/as3/#as3","text":"TODO\uff1a\u6b63\u5728\u5b8c\u5584\u4e2d","title":"AS3\u5185\u5bb9\u914d\u7f6e\u6307\u5f15"},{"location":"Architecture/parameters/","text":"\u542f\u52a8\u53c2\u6570 \u00b6 bigip-url: \u5fc5\u586b, Big-IP \u7684 URL\u5730\u5740\u3002 \u5982: https://10.10.10.10:8443 bigip-username: \u5fc5\u586b, Big-IP \u7528\u6237\u7684\u8d26\u53f7\u540d bigip-password: \u5fc5\u586b, Big-IP \u76f8\u5e94\u8d26\u53f7\u7684\u5bc6\u7801 log-level: \u53ef\u9009\u3002\u8f93\u51fa\u65e5\u5fd7\u7684\u7ea7\u522b flannel-name: \u53ef\u9009\u3002\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u3002\u82e5\u4e0d\u586bflannel-name\uff0c\u5219\u9ed8\u8ba4\u8be5k8s\u73af\u5883\u4f7f\u7528calico\uff0c\u586b\u4e0aflannel-name\u5219\u8ba4\u4e3a\u8be5k8s\u73af\u5883\u4f7f\u7528flannel\u63d2\u4ef6 namespace: \u6807\u8bc6CIS-C\u5c06\u76d1\u542c\u7684namespace\u540d\u79f0\u3002\u53ef\u4ee5\u586b\u5165\u591a\u884c --namespace \uff0c\u4ee3\u8868CIS-C\u5c06\u76d1\u542c\u591a\u4e2anamespace\u5185\u7684\u8d44\u6e90\u53d8\u5316 namespace-label \uff1a\u6807\u8bc6CIS-C\u5c06\u76d1\u542c\u8be5label\u7b5b\u9009\u540e\u7684namespaces\u3002\u8be5\u53c2\u6570\u53ef\u4e0enamespace\u53c2\u6570\u642d\u914d\u4f7f\u7528","title":"\u542f\u52a8\u53c2\u6570"},{"location":"Architecture/parameters/#_1","text":"bigip-url: \u5fc5\u586b, Big-IP \u7684 URL\u5730\u5740\u3002 \u5982: https://10.10.10.10:8443 bigip-username: \u5fc5\u586b, Big-IP \u7528\u6237\u7684\u8d26\u53f7\u540d bigip-password: \u5fc5\u586b, Big-IP \u76f8\u5e94\u8d26\u53f7\u7684\u5bc6\u7801 log-level: \u53ef\u9009\u3002\u8f93\u51fa\u65e5\u5fd7\u7684\u7ea7\u522b flannel-name: \u53ef\u9009\u3002\u9ed8\u8ba4\u503c\u4e3a\u7a7a\u3002\u82e5\u4e0d\u586bflannel-name\uff0c\u5219\u9ed8\u8ba4\u8be5k8s\u73af\u5883\u4f7f\u7528calico\uff0c\u586b\u4e0aflannel-name\u5219\u8ba4\u4e3a\u8be5k8s\u73af\u5883\u4f7f\u7528flannel\u63d2\u4ef6 namespace: \u6807\u8bc6CIS-C\u5c06\u76d1\u542c\u7684namespace\u540d\u79f0\u3002\u53ef\u4ee5\u586b\u5165\u591a\u884c --namespace \uff0c\u4ee3\u8868CIS-C\u5c06\u76d1\u542c\u591a\u4e2anamespace\u5185\u7684\u8d44\u6e90\u53d8\u5316 namespace-label \uff1a\u6807\u8bc6CIS-C\u5c06\u76d1\u542c\u8be5label\u7b5b\u9009\u540e\u7684namespaces\u3002\u8be5\u53c2\u6570\u53ef\u4e0enamespace\u53c2\u6570\u642d\u914d\u4f7f\u7528","title":"\u542f\u52a8\u53c2\u6570"},{"location":"Operation-and-troubleshooting/ki/","text":"\u5df2\u77e5\u95ee\u9898 \u00b6 \u95ee\u98981\uff1a\u76f4\u63a5\u5220\u9664ns\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u91cd\u542f\uff0c\u6b64\u95ee\u9898\u5076\u7136\u51fa\u73b0\u3002 \u5f71\u54cd\u8303\u56f4\uff1a\u8d44\u6e90\u4f9d\u65e7\u4f1a\u88ab\u5220\u9664\uff0c\u4f46\u662f\u7a0b\u5e8f\u91cd\u542f\u4f1a\u5bfc\u81f4\u91cd\u542f\u8fc7\u7a0b\u4e2d\u7684\u90e8\u5206\u4e0b\u53d1\u5ef6\u65f6\u589e\u52a0\uff0c\u589e\u52a0\u4e0b\u53d1\u5931\u8d25\u7684\u53ef\u80fd\u6027\u3002 \u95ee\u9898\u539f\u56e0\uff1a\u76f4\u63a5\u5220\u9664namespace\u65f6\uff0c\u5176\u4e0b\u7684\u5404\u8d44\u6e90\u4e00\u5e76\u4f1a\u88ab\u5220\u9664\uff0c\u7a0b\u5e8f\u5728\u4e0a\u4f20\u8d44\u6e90\u72b6\u6001\u65f6\u56e0\u627e\u4e0d\u5230namespace\u800c\u5931\u8d25\u3002\u5177\u4f53\u95ee\u9898\u63cf\u8ff0\u89c1\uff1a https://github.com/kubernetes/client-go/issues/1125 \u89e3\u51b3\u65b9\u6848\uff1a\u5173\u95ed\u8d44\u6e90\u72b6\u6001\u4e0a\u4f20\u529f\u80fd\uff0c\u6216\u5bfb\u6c42\u793e\u533a\u652f\u6301\uff0c\u534f\u52a9\u5b9a\u4f4d\u5e76\u89e3\u51b3\u95ee\u9898\u3002 \u95ee\u98982\uff1a\u7528\u6237\u80fd\u591f\u5c06AS3 declaration\u62c6\u5206\u4e3a\u591a\u4e2aconfigmap\u5206\u522b\u4e0b\u53d1\u3002 \u5f71\u54cd\u8303\u56f4\uff1a\u5373\uff0c\u5b8c\u6574\u7684AS3 declaration\u5c06\u7531\u591a\u4e2aconfigmap \u7ec4\u6210\uff0c\u6bcf\u4e2aconfigmap\u8d1f\u8d23\u58f0\u660e\u8be5AS3 declaration\u6240\u6307\u5b9a\u7684partition\u7684\u4e00\u90e8\u5206 \u95ee\u9898\u539f\u56e0\uff1a\u636eAS3 declaration \u58f0\u660e\u5f0f\u7684\u7279\u6027\uff0c\u540c\u4e00declaration\u9700\u8981\u5305\u542b\u5b8c\u6574\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u5206\u62c6declaration \u8fdd\u80cc\u4e86\u8fd9\u4e00\u58f0\u660e\u5f0f\u8bed\u8a00\u7684\u57fa\u672c\u7279\u6027\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u76ee\u524d\u65e0\u6cd5\u652f\u6301\u5c06AS3 declaration\u5206\u62c6\u4e0b\u53d1\u7684\u80fd\u529b\uff0c\u8fd9\u6837\u975e\u5e38\u5bb9\u6613\u5f15\u53d1\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u589e\u52a0\u7a0b\u5e8f\u7ef4\u62a4\u590d\u6742\u5ea6\u3002\u8003\u8651\u653e\u5728\u5c06\u6765\u7279\u6027\u4e2d\u8c03\u7814\u5b9e\u73b0\u601d\u8def\u3002 \u95ee\u98983\uff1a\u9488\u5bf9\u67d0\u79df\u6237\uff08partition\uff09\u7684\u914d\u7f6e\uff0c\u5fc5\u987b\u901a\u8fc7\u67d0\u4e00\u786e\u5b9aconfigmap\u4e0b\u53d1\uff0cconfigmap\u4e0d\u53ef\u53d8\u66f4\u3002 \u5f71\u54cd\u8303\u56f4\uff1apartition x \u901a\u8fc7 configmap a\u5b8c\u6210\u4e0b\u53d1\u540e\uff0cconfigmap b\u4e2d\u5373\u4fbf\u5305\u542b\u4e86partition x\u7684\u5b9a\u4e49\uff0c\u4e0b\u53d1\u540e\u4e5f\u4e0d\u4f1a\u751f\u6548\u3002\u60f3\u8981\u6539\u52a8partition x\uff0c\u53ea\u80fd\u901a\u8fc7 configmap a\u3002 \u95ee\u9898\u539f\u56e0\uff1a\u6b64\u95ee\u9898\u5e76\u975e\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u800c\u662f\u4e00\u79cd\u7ea6\u675f\u3002configmap a\u4e0b\u53d1\u540e\u4f1a\u5f62\u6210\u5bf9partition x\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u907f\u514d\u540e\u7eed\u5230\u6765\u7684configmap\u5bf9\u65e2\u6709\u4e1a\u52a1\u4ea7\u751f\u9519\u8bef\u5f71\u54cd\u3002\u6b64\u7ea6\u675f\u5bf9endpoints\u8d44\u6e90\u4e5f\u6709\u6548\uff0c\u5373\uff0c\u5bf9\u67d0\u4e00\u4e2a\u7279\u5b9apool x\u7684\u6539\u52a8\u53ea\u80fd\u901a\u8fc7endpoints a\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5982\u4e0a\u6240\u793a\uff0cpartition x \u4ec5\u80fd\u901a\u8fc7configmap a\u4e0b\u53d1\uff0c\u540e\u7eed\u5bf9partition x\u7684\u4fee\u6539\u3001\u5220\u9664\uff0c\u5747\u53ea\u80fd\u901a\u8fc7configmap a\u5b8c\u6210\u3002","title":"\u5e38\u89c1\u95ee\u9898"},{"location":"Operation-and-troubleshooting/ki/#_1","text":"\u95ee\u98981\uff1a\u76f4\u63a5\u5220\u9664ns\u5bfc\u81f4\u7a0b\u5e8f\u5d29\u6e83\u91cd\u542f\uff0c\u6b64\u95ee\u9898\u5076\u7136\u51fa\u73b0\u3002 \u5f71\u54cd\u8303\u56f4\uff1a\u8d44\u6e90\u4f9d\u65e7\u4f1a\u88ab\u5220\u9664\uff0c\u4f46\u662f\u7a0b\u5e8f\u91cd\u542f\u4f1a\u5bfc\u81f4\u91cd\u542f\u8fc7\u7a0b\u4e2d\u7684\u90e8\u5206\u4e0b\u53d1\u5ef6\u65f6\u589e\u52a0\uff0c\u589e\u52a0\u4e0b\u53d1\u5931\u8d25\u7684\u53ef\u80fd\u6027\u3002 \u95ee\u9898\u539f\u56e0\uff1a\u76f4\u63a5\u5220\u9664namespace\u65f6\uff0c\u5176\u4e0b\u7684\u5404\u8d44\u6e90\u4e00\u5e76\u4f1a\u88ab\u5220\u9664\uff0c\u7a0b\u5e8f\u5728\u4e0a\u4f20\u8d44\u6e90\u72b6\u6001\u65f6\u56e0\u627e\u4e0d\u5230namespace\u800c\u5931\u8d25\u3002\u5177\u4f53\u95ee\u9898\u63cf\u8ff0\u89c1\uff1a https://github.com/kubernetes/client-go/issues/1125 \u89e3\u51b3\u65b9\u6848\uff1a\u5173\u95ed\u8d44\u6e90\u72b6\u6001\u4e0a\u4f20\u529f\u80fd\uff0c\u6216\u5bfb\u6c42\u793e\u533a\u652f\u6301\uff0c\u534f\u52a9\u5b9a\u4f4d\u5e76\u89e3\u51b3\u95ee\u9898\u3002 \u95ee\u98982\uff1a\u7528\u6237\u80fd\u591f\u5c06AS3 declaration\u62c6\u5206\u4e3a\u591a\u4e2aconfigmap\u5206\u522b\u4e0b\u53d1\u3002 \u5f71\u54cd\u8303\u56f4\uff1a\u5373\uff0c\u5b8c\u6574\u7684AS3 declaration\u5c06\u7531\u591a\u4e2aconfigmap \u7ec4\u6210\uff0c\u6bcf\u4e2aconfigmap\u8d1f\u8d23\u58f0\u660e\u8be5AS3 declaration\u6240\u6307\u5b9a\u7684partition\u7684\u4e00\u90e8\u5206 \u95ee\u9898\u539f\u56e0\uff1a\u636eAS3 declaration \u58f0\u660e\u5f0f\u7684\u7279\u6027\uff0c\u540c\u4e00declaration\u9700\u8981\u5305\u542b\u5b8c\u6574\u7684\u914d\u7f6e\u4fe1\u606f\u3002\u5206\u62c6declaration \u8fdd\u80cc\u4e86\u8fd9\u4e00\u58f0\u660e\u5f0f\u8bed\u8a00\u7684\u57fa\u672c\u7279\u6027\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u76ee\u524d\u65e0\u6cd5\u652f\u6301\u5c06AS3 declaration\u5206\u62c6\u4e0b\u53d1\u7684\u80fd\u529b\uff0c\u8fd9\u6837\u975e\u5e38\u5bb9\u6613\u5f15\u53d1\u6570\u636e\u4e0d\u4e00\u81f4\uff0c\u589e\u52a0\u7a0b\u5e8f\u7ef4\u62a4\u590d\u6742\u5ea6\u3002\u8003\u8651\u653e\u5728\u5c06\u6765\u7279\u6027\u4e2d\u8c03\u7814\u5b9e\u73b0\u601d\u8def\u3002 \u95ee\u98983\uff1a\u9488\u5bf9\u67d0\u79df\u6237\uff08partition\uff09\u7684\u914d\u7f6e\uff0c\u5fc5\u987b\u901a\u8fc7\u67d0\u4e00\u786e\u5b9aconfigmap\u4e0b\u53d1\uff0cconfigmap\u4e0d\u53ef\u53d8\u66f4\u3002 \u5f71\u54cd\u8303\u56f4\uff1apartition x \u901a\u8fc7 configmap a\u5b8c\u6210\u4e0b\u53d1\u540e\uff0cconfigmap b\u4e2d\u5373\u4fbf\u5305\u542b\u4e86partition x\u7684\u5b9a\u4e49\uff0c\u4e0b\u53d1\u540e\u4e5f\u4e0d\u4f1a\u751f\u6548\u3002\u60f3\u8981\u6539\u52a8partition x\uff0c\u53ea\u80fd\u901a\u8fc7 configmap a\u3002 \u95ee\u9898\u539f\u56e0\uff1a\u6b64\u95ee\u9898\u5e76\u975e\u9700\u8981\u89e3\u51b3\u7684\u95ee\u9898\uff0c\u800c\u662f\u4e00\u79cd\u7ea6\u675f\u3002configmap a\u4e0b\u53d1\u540e\u4f1a\u5f62\u6210\u5bf9partition x\u7684\u7ed1\u5b9a\u5173\u7cfb\uff0c\u907f\u514d\u540e\u7eed\u5230\u6765\u7684configmap\u5bf9\u65e2\u6709\u4e1a\u52a1\u4ea7\u751f\u9519\u8bef\u5f71\u54cd\u3002\u6b64\u7ea6\u675f\u5bf9endpoints\u8d44\u6e90\u4e5f\u6709\u6548\uff0c\u5373\uff0c\u5bf9\u67d0\u4e00\u4e2a\u7279\u5b9apool x\u7684\u6539\u52a8\u53ea\u80fd\u901a\u8fc7endpoints a\u3002 \u89e3\u51b3\u65b9\u6848\uff1a\u5982\u4e0a\u6240\u793a\uff0cpartition x \u4ec5\u80fd\u901a\u8fc7configmap a\u4e0b\u53d1\uff0c\u540e\u7eed\u5bf9partition x\u7684\u4fee\u6539\u3001\u5220\u9664\uff0c\u5747\u53ea\u80fd\u901a\u8fc7configmap a\u5b8c\u6210\u3002","title":"\u5df2\u77e5\u95ee\u9898"},{"location":"Operation-and-troubleshooting/migration/","text":"\u8fc1\u79fb \u00b6 TODO: \u7565","title":"\u8fc1\u79fb"},{"location":"Operation-and-troubleshooting/migration/#_1","text":"TODO: \u7565","title":"\u8fc1\u79fb"},{"location":"Release-notes/","text":"\u7248\u672c\u53d1\u5e03 \u00b6 Release: 2.9.1-20220804 \u00b6 Docker image \u00b6 f5devcentral/k8s-bigip-ctlr-c:2.9.1-20220804 Release Notes \u00b6 \u90e8\u7f72\u4e0e\u73af\u5883\u652f\u6301 \u00b6 \u652f\u6301\u96c6\u7fa4\u5185\u548c\u96c6\u7fa4\u5916\u8fd0\u884c\u4e24\u79cd\u6a21\u5f0f \u652f\u6301k8s\u96c6\u7fa4\u4e1a\u52a1\u914d\u7f6e\u65b9\u5f0f\uff1adeployment+service\uff0c\u5e94\u7528\u4ea4\u4ed8\uff08\u5e94\u7528\u5bf9\u5916\u53d1\u5e03\uff09\u914d\u7f6e\u65b9\u5f0f\uff1aconfigmap( F5 AS3 \u4f5c\u4e3a\u6570\u636e\u4e3b\u4f53) \u652f\u6301k8s CNI\u7c7b\u578b\uff1aFlannel vxlan\u6216\u5176\u5b83underlay\u6a21\u5f0fCNI\uff08\u5982Calico\u8def\u7531\u6a21\u5f0f\uff0cKube-ovn underlay\u6a21\u5f0f\u7b49\uff09\uff0c\u914d\u7f6e\u7ec6\u8282\u53ef\u53c2\u8003 \u8fd9\u91cc \u652f\u6301\u5e7f\u6cdb\u7684k8s\u7248\u672c\uff0c\u5982\u60a8\u53d1\u73b0k8s\u7684\u7248\u672c\u652f\u6301\u95ee\u9898\uff0c\u8bf7 \u8054\u7cfb\u6211\u4eec \u6682\u4e0d\u652f\u6301Openshift \u652f\u6301x86 CPU\u3002 \u56fd\u4ea7\u6216ARM CPU\u652f\u6301\u8bf7\u4e0e\u6211\u4eec \u8054\u7cfb \u529f\u80fd\u4e0e\u884c\u4e3a\u652f\u6301 \u00b6 \u652f\u6301\u901a\u8fc7 namespace \u542f\u52a8\u53c2\u6570\u6307\u5b9a\u4e1a\u52a1\u53d1\u5e03\u8303\u56f4 \u652f\u6301\u4f7f\u7528 namespace-label \u542f\u52a8\u53c2\u6570\u6807\u8bb0\u4e1a\u52a1\u53d1\u5e03\u8303\u56f4\uff0c\u5b9e\u73b0\u6307\u5b9a\u8303\u56f4\u7684\u52a8\u6001\u6027 \u652f\u6301hub-mode\u65b9\u5f0f\uff0c\u4ee5\u4fbf\u4e1a\u52a1\u548c\u5e94\u7528\u4ea4\u4ed8\u914d\u7f6e\u53ef\u4ee5\u5728\u4e0d\u540c\u7684namespace\u4e2d\u5206\u522b\u8fdb\u884c\uff0c\u5b9e\u73b0\u4e0d\u540c\u89d2\u8272\u56e2\u961f\u7684\u5de5\u4f5c\u89e3\u8026 \u652f\u6301\u670d\u52a1\u7ed1\u5b9a\u4fdd\u62a4\uff0c\u907f\u514d\u8bef\u64cd\u4f5c\u5e26\u6765\u7684\u670d\u52a1\u8986\u76d6\u5f02\u5e38 \u652f\u6301\u9ed8\u8ba4\u670d\u52a1\u7aef\u53e3\u7ed1\u5b9a\uff1a\u5f53configmap\u5e94\u7528\u914d\u7f6e\u4e2d\u65e0\u7aef\u53e3\u6307\u5b9a\u65f6\uff0c\u81ea\u52a8\u9009\u62e9\u670d\u52a1\u7aef\u53e3 \u652f\u6301\u589e\u91cf\u5904\u7406\uff0c\u5e94\u7528\u4ea4\u4ed8\u914d\u7f6e\u4e0b\u53d1\u901f\u5ea6\u5feb \u652f\u6301BIG-IP\u4e0a\u6269\u5c55\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u5305\u62ec\u4ee5\u4e0b\u914d\u7f6e\u5bf9\u8c61\uff08\u53ca\u5176\u5b50\u53c2\u6570\u914d\u7f6e\u9879\uff09\uff0c\u652f\u6301\u7528\u6237\u5145\u5206\u53d1\u6325BIG-IP\u80fd\u529b\u3002\u66f4\u591a\u573a\u666f\u53ef\u53c2\u8003 \u8fd9\u91cc \uff1a * virtual * virtual-address * snatpool * pool/member/node * monitor\uff1agateway_icmp tcp udp http * profile: tcp ftp udp http clientssl oneconnect * persist: cookie source_addr * iRules \u652f\u6301IPv64\u8f6c\u6362,\u5373\u5bf9\u5916\u53d1\u5e03IPv6\u8bbf\u95eeIP\uff0c\u96c6\u7fa4\u5185\u4f7f\u7528IPv4\u3002\u4ea6\u652f\u6301\u96c6\u7fa4\u5185IPv6 \u8fd0\u7ef4\u4e0e\u5347\u7ea7\u652f\u6301 \u00b6 \u517c\u5bb9\u7528\u6237\u5f53\u524d\u5728CIS\u4e2d\u5df2\u7ecf\u53d1\u5e03\u7684configmap yaml\u683c\u5f0f\uff0c\u7528\u6237\u5728CIS-C\u4e2d\u65e0\u6cd5\u4fee\u6539\u5e94\u7528\u53d1\u5e03yaml \u652f\u6301\u4eceCIS\u5347\u7ea7\u5230CIS-C\uff0c\u9700\u8981\u501f\u52a9kic-tool\u5de5\u5177\u5b8c\u6210\u5347\u7ea7\u8fc1\u79fb \u652f\u6301\u65e5\u5fd7\u7ea7\u522b\u8f93\u51fa\u3001\u548c\u4efb\u52a1\u8ddf\u8e2a\uff08request_id\uff09 \u652f\u6301\u4e0ePrometheus\u96c6\u6210\uff0c\u91c7\u96c6\u63a7\u5236\u5668\u6027\u80fd\u6570\u636e \u5728\u6709\u6548\u7ba1\u7406\u4e0b\uff0cF5 CIS-C\u53ef\u4ee5\u4e0eF5 CIS\u540c\u65f6\u8fd0\u884c\uff0c\u5b9e\u73b0\u66f4\u7075\u6d3b\u4e30\u5bcc\u7684\u573a\u666f\u5e94\u5bf9","title":"\u7248\u672c\u53d1\u5e03"},{"location":"Release-notes/#_1","text":"","title":"\u7248\u672c\u53d1\u5e03"},{"location":"Release-notes/#release-291-20220804","text":"","title":"Release: 2.9.1-20220804"},{"location":"Release-notes/#docker-image","text":"f5devcentral/k8s-bigip-ctlr-c:2.9.1-20220804","title":"Docker image"},{"location":"Release-notes/#release-notes","text":"","title":"Release Notes"},{"location":"Release-notes/#_2","text":"\u652f\u6301\u96c6\u7fa4\u5185\u548c\u96c6\u7fa4\u5916\u8fd0\u884c\u4e24\u79cd\u6a21\u5f0f \u652f\u6301k8s\u96c6\u7fa4\u4e1a\u52a1\u914d\u7f6e\u65b9\u5f0f\uff1adeployment+service\uff0c\u5e94\u7528\u4ea4\u4ed8\uff08\u5e94\u7528\u5bf9\u5916\u53d1\u5e03\uff09\u914d\u7f6e\u65b9\u5f0f\uff1aconfigmap( F5 AS3 \u4f5c\u4e3a\u6570\u636e\u4e3b\u4f53) \u652f\u6301k8s CNI\u7c7b\u578b\uff1aFlannel vxlan\u6216\u5176\u5b83underlay\u6a21\u5f0fCNI\uff08\u5982Calico\u8def\u7531\u6a21\u5f0f\uff0cKube-ovn underlay\u6a21\u5f0f\u7b49\uff09\uff0c\u914d\u7f6e\u7ec6\u8282\u53ef\u53c2\u8003 \u8fd9\u91cc \u652f\u6301\u5e7f\u6cdb\u7684k8s\u7248\u672c\uff0c\u5982\u60a8\u53d1\u73b0k8s\u7684\u7248\u672c\u652f\u6301\u95ee\u9898\uff0c\u8bf7 \u8054\u7cfb\u6211\u4eec \u6682\u4e0d\u652f\u6301Openshift \u652f\u6301x86 CPU\u3002 \u56fd\u4ea7\u6216ARM CPU\u652f\u6301\u8bf7\u4e0e\u6211\u4eec \u8054\u7cfb","title":"\u90e8\u7f72\u4e0e\u73af\u5883\u652f\u6301"},{"location":"Release-notes/#_3","text":"\u652f\u6301\u901a\u8fc7 namespace \u542f\u52a8\u53c2\u6570\u6307\u5b9a\u4e1a\u52a1\u53d1\u5e03\u8303\u56f4 \u652f\u6301\u4f7f\u7528 namespace-label \u542f\u52a8\u53c2\u6570\u6807\u8bb0\u4e1a\u52a1\u53d1\u5e03\u8303\u56f4\uff0c\u5b9e\u73b0\u6307\u5b9a\u8303\u56f4\u7684\u52a8\u6001\u6027 \u652f\u6301hub-mode\u65b9\u5f0f\uff0c\u4ee5\u4fbf\u4e1a\u52a1\u548c\u5e94\u7528\u4ea4\u4ed8\u914d\u7f6e\u53ef\u4ee5\u5728\u4e0d\u540c\u7684namespace\u4e2d\u5206\u522b\u8fdb\u884c\uff0c\u5b9e\u73b0\u4e0d\u540c\u89d2\u8272\u56e2\u961f\u7684\u5de5\u4f5c\u89e3\u8026 \u652f\u6301\u670d\u52a1\u7ed1\u5b9a\u4fdd\u62a4\uff0c\u907f\u514d\u8bef\u64cd\u4f5c\u5e26\u6765\u7684\u670d\u52a1\u8986\u76d6\u5f02\u5e38 \u652f\u6301\u9ed8\u8ba4\u670d\u52a1\u7aef\u53e3\u7ed1\u5b9a\uff1a\u5f53configmap\u5e94\u7528\u914d\u7f6e\u4e2d\u65e0\u7aef\u53e3\u6307\u5b9a\u65f6\uff0c\u81ea\u52a8\u9009\u62e9\u670d\u52a1\u7aef\u53e3 \u652f\u6301\u589e\u91cf\u5904\u7406\uff0c\u5e94\u7528\u4ea4\u4ed8\u914d\u7f6e\u4e0b\u53d1\u901f\u5ea6\u5feb \u652f\u6301BIG-IP\u4e0a\u6269\u5c55\u5e94\u7528\u4ea4\u4ed8\u80fd\u529b\u5305\u62ec\u4ee5\u4e0b\u914d\u7f6e\u5bf9\u8c61\uff08\u53ca\u5176\u5b50\u53c2\u6570\u914d\u7f6e\u9879\uff09\uff0c\u652f\u6301\u7528\u6237\u5145\u5206\u53d1\u6325BIG-IP\u80fd\u529b\u3002\u66f4\u591a\u573a\u666f\u53ef\u53c2\u8003 \u8fd9\u91cc \uff1a * virtual * virtual-address * snatpool * pool/member/node * monitor\uff1agateway_icmp tcp udp http * profile: tcp ftp udp http clientssl oneconnect * persist: cookie source_addr * iRules \u652f\u6301IPv64\u8f6c\u6362,\u5373\u5bf9\u5916\u53d1\u5e03IPv6\u8bbf\u95eeIP\uff0c\u96c6\u7fa4\u5185\u4f7f\u7528IPv4\u3002\u4ea6\u652f\u6301\u96c6\u7fa4\u5185IPv6","title":"\u529f\u80fd\u4e0e\u884c\u4e3a\u652f\u6301"},{"location":"Release-notes/#_4","text":"\u517c\u5bb9\u7528\u6237\u5f53\u524d\u5728CIS\u4e2d\u5df2\u7ecf\u53d1\u5e03\u7684configmap yaml\u683c\u5f0f\uff0c\u7528\u6237\u5728CIS-C\u4e2d\u65e0\u6cd5\u4fee\u6539\u5e94\u7528\u53d1\u5e03yaml \u652f\u6301\u4eceCIS\u5347\u7ea7\u5230CIS-C\uff0c\u9700\u8981\u501f\u52a9kic-tool\u5de5\u5177\u5b8c\u6210\u5347\u7ea7\u8fc1\u79fb \u652f\u6301\u65e5\u5fd7\u7ea7\u522b\u8f93\u51fa\u3001\u548c\u4efb\u52a1\u8ddf\u8e2a\uff08request_id\uff09 \u652f\u6301\u4e0ePrometheus\u96c6\u6210\uff0c\u91c7\u96c6\u63a7\u5236\u5668\u6027\u80fd\u6570\u636e \u5728\u6709\u6548\u7ba1\u7406\u4e0b\uff0cF5 CIS-C\u53ef\u4ee5\u4e0eF5 CIS\u540c\u65f6\u8fd0\u884c\uff0c\u5b9e\u73b0\u66f4\u7075\u6d3b\u4e30\u5bcc\u7684\u573a\u666f\u5e94\u5bf9","title":"\u8fd0\u7ef4\u4e0e\u5347\u7ea7\u652f\u6301"},{"location":"Support-and-contact/","text":"\u652f\u6301\u4e0e\u8054\u7cfb \u00b6 \u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u83b7\u5f97\u6280\u672f\u652f\u6301\u4e0e\u670d\u52a1\uff1a \u4ee5Github Issues \u65b9\u5f0f\u5728\u793e\u533a\u5185\u63d0\u4ea4\uff0c\u8fd9\u662f\u4f18\u5148\u5efa\u8bae\u7684\u65b9\u5f0f\u3002 \u5728\u6807\u51c6\u5de5\u4f5c\u65f6\u95f4\u5185\uff089AM-18PM \u5317\u4eac\u65f6\u533a)\u62e8\u6253F5\u6280\u672f\u652f\u6301\u70ed\u7ebf\u3002\u5982\u60a8\u7684BIG-IP\u5177\u67097*24\u670d\u52a1\uff0c\u5728\u975e\u5de5\u4f5c\u65f6\u95f4\u5185\u60a8\u53ef\u4ee5\u7d27\u6025\u8054\u7cfb\u5bf9\u5e94\u6280\u672f\u652f\u6301\u5de5\u7a0b\u5e08\u3002","title":"\u6280\u672f\u652f\u6301"},{"location":"Support-and-contact/#_1","text":"\u60a8\u53ef\u4ee5\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f\u83b7\u5f97\u6280\u672f\u652f\u6301\u4e0e\u670d\u52a1\uff1a \u4ee5Github Issues \u65b9\u5f0f\u5728\u793e\u533a\u5185\u63d0\u4ea4\uff0c\u8fd9\u662f\u4f18\u5148\u5efa\u8bae\u7684\u65b9\u5f0f\u3002 \u5728\u6807\u51c6\u5de5\u4f5c\u65f6\u95f4\u5185\uff089AM-18PM \u5317\u4eac\u65f6\u533a)\u62e8\u6253F5\u6280\u672f\u652f\u6301\u70ed\u7ebf\u3002\u5982\u60a8\u7684BIG-IP\u5177\u67097*24\u670d\u52a1\uff0c\u5728\u975e\u5de5\u4f5c\u65f6\u95f4\u5185\u60a8\u53ef\u4ee5\u7d27\u6025\u8054\u7cfb\u5bf9\u5e94\u6280\u672f\u652f\u6301\u5de5\u7a0b\u5e08\u3002","title":"\u652f\u6301\u4e0e\u8054\u7cfb"},{"location":"Support-and-contact/doc-revise/","text":"\u6b22\u8fce\u8d21\u732e\u6587\u6863 \u00b6 \u5982\u60a8\u53d1\u73b0\u6587\u6863\u6709\u4efb\u4f55\u9519\u8bef\uff0c\u6b22\u8fce\u4ee5Github Issues \u65b9\u5f0f\u63d0\u51fa\u3002\u6216\u76f4\u63a5PR\u66f4\u65b0\u7ed9\u6211\u4eec\u3002 \u60a8\u7684\u8d21\u732e\u5c06\u88ab\u5c55\u793a\u5728\u8fd9\u91cc\u3002\u5f53\u524d\u6587\u6863\u8d21\u732e\u4eba\u5458\uff1a myf5 Jing Lin Niklaus-xie zongzw f5zong jinjia812","title":"\u6587\u6863\u7ea0\u9519"},{"location":"Support-and-contact/doc-revise/#_1","text":"\u5982\u60a8\u53d1\u73b0\u6587\u6863\u6709\u4efb\u4f55\u9519\u8bef\uff0c\u6b22\u8fce\u4ee5Github Issues \u65b9\u5f0f\u63d0\u51fa\u3002\u6216\u76f4\u63a5PR\u66f4\u65b0\u7ed9\u6211\u4eec\u3002 \u60a8\u7684\u8d21\u732e\u5c06\u88ab\u5c55\u793a\u5728\u8fd9\u91cc\u3002\u5f53\u524d\u6587\u6863\u8d21\u732e\u4eba\u5458\uff1a myf5 Jing Lin Niklaus-xie zongzw f5zong jinjia812","title":"\u6b22\u8fce\u8d21\u732e\u6587\u6863"},{"location":"Use-Cases/ftp/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"FTP\u4e1a\u52a1\u53d1\u5e03"},{"location":"Use-Cases/ftp/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/http/","text":"1.\u6807\u51c6HTTP\u4e1a\u52a1\u53d1\u5e03\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u6807\u51c6HTTP\u4e1a\u52a1\u53d1\u5e03 HTTP\u4e1a\u52a1\u9ed8\u8ba4\u53c2\u6570\u8bf4\u660e\uff1a Snat\u4e3aauto\uff0c\u610f\u601d\u662fautomap persistenceMethods\u4e3acookie\uff0c\u610f\u601d\u9ed8\u8ba4\u4f1a\u8bdd\u4fdd\u6301\u662fcookie VS\u7c7b\u578b\u4e3astandard \u9ed8\u8ba4\u4f1a\u4f7f\u7528http profile \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-11 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vs1\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [ \"172.16.142.181\" ], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test005/app_svc_vs1 ltm virtual test005/app_svc_vs1 { creation-time 2022-08-02:16:28:32 description test005 destination 172.16.142.181:xfer ip-protocol tcp last-modified-time 2022-08-02:16:28:32 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 933 } 2.\u914d\u7f6evirtual address\u5c5e\u6027\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6evirtual address\u5bf9\u8c61, arp enable no\uff0c virtual server \u5f15\u7528\u8be5\u5bf9\u8c61 \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-2 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.178\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test005/app_svc_vs2 ltm virtual test005/app_svc_vs2 { creation-time 2022-08-02:16:43:17 description test005 destination 172.16.142.178:xfer ip-protocol tcp last-modified-time 2022-08-02:16:43:17 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 934 } list ltm virtual-address 172.16.142.178 ltm virtual-address 172.16.142.178 { address 172.16.142.178 arp disabled inherited-traffic-group true mask 255.255.255.255 partition test005 traffic-group /Common/traffic-group-1 } 3.\u914d\u7f6eTCP profile\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6eTCP profile\uff0c\u81ea\u5b9a\u4e49\u8d85\u65f6\u65f6\u95f4 \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-3 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"customTCPProfile\": { \"class\": \"TCP_Profile\", \"idleTimeout\": 600 }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.178\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip\" }], \"virtualPort\": 82, \"profileTCP\": { \"use\": \"customTCPProfile\" }, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test005/app_svc_vs2 ltm virtual test005/app_svc_vs2 { creation-time 2022-08-02:17:04:31 description test005 destination 172.16.142.178:xfer ip-protocol tcp last-modified-time 2022-08-02:17:04:31 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/http { } test005/customTCPProfile { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 935 } list ltm profile tcp test005/customTCPProfile | grep idle-timeout idle-timeout 600 4.\u914d\u7f6eHTTP profile\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6eHTTP profile\uff0c\u5f00\u542fXFF \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-4 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"customHTTPProfile\": { \"class\": \"HTTP_Profile\", \"xForwardedFor\": true }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip4\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.188\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip4\" }], \"virtualPort\": 82, \"profileHTTP\": { \"use\": \"customHTTPProfile\" }, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs2 ltm virtual test006/app_svc_vs2 { creation-time 2022-08-02:17:57:57 description test006 destination 172.16.142.188:xfer ip-protocol tcp last-modified-time 2022-08-02:17:57:57 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } test006/customHTTPProfile { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 946 } list ltm profile http test006/customHTTPProfile | grep \"insert-xforwarded-for\" insert-xforwarded-for enabled 5.\u914d\u7f6ecookie\u4f1a\u8bdd\u4fdd\u6301\uff0ccookie\u52a0\u5bc6\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6ecookie\u4f1a\u8bdd\u4fdd\u6301\uff0c\u5bf9F5 insert\u7684cookie\u8fdb\u884c\u52a0\u5bc6 \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"cookie_encryption\": { \"class\": \"Persist\", \"persistenceMethod\": \"cookie\", \"encrypt\": true, \"cookieMethod\": \"insert\", \"passphrase\": { \"ciphertext\": \"a3RjeGZ5Z2Q=\", \"protected\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJub25lIn0=\" } }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"persistenceMethods\": [{ \"use\": \"cookie_encryption\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:31:30 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:31:30 mask 255.255.255.255 partition test006 persist { test006/cookie_encryption { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 939 } list ltm persistence cookie test006/cookie_encryption ltm persistence cookie test006/cookie_encryption { always-send disabled app-service none cookie-encryption required cookie-encryption-passphrase $M$t7$uQ0K+M40jOAbMER6IY+BSA== cookie-name none expiration 0 httponly enabled match-across-pools disabled match-across-services disabled match-across-virtuals disabled method insert mirror disabled override-connection-limit disabled secure enabled timeout indefinite } 6.\u914d\u7f6esnat pool\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6esnat pool\u8303\u4f8b \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"snatpool-3\": { \"class\": \"SNAT_Pool\", \"snatAddresses\": [ \"172.16.142.21\", \"172.16.142.22\" ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"snat\": { \"use\": \"snatpool-3\" }, \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:36:04 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:36:04 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { pool test006/snatpool-3 type snat } translate-address enabled translate-port enabled vs-index 940 } list ltm snatpool test006/snatpool-3 ltm snatpool test006/snatpool-3 { members { 172.16.142.21 172.16.142.22 } partition test006 } 7.\u914d\u7f6eone connect\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6eone connect\u8303\u4f8b \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"customOne\": { \"class\": \"Multiplex_Profile\", \"sourceMask\": \"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\" }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"profileMultiplex\": { \"use\": \"customOne\" }, \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:40:20 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:40:20 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } test006/customOne { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 941 } list ltm profile one-connect test006/customOne ltm profile one-connect test006/customOne { app-service none idle-timeout-override disabled limit-type none max-age 86400 max-reuse 1000 max-size 10000 share-pools disabled source-mask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff } 8.\u914d\u7f6eVS \u94fe\u63a5\u9650\u5236\uff0c immediate action on svc down\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6eVS \u94fe\u63a5\u9650\u5236\uff0c immediate action on svc down \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"virtualPort\": 82, \"serviceDownImmediateAction\": \"reset\", \"maxConnections\": 123, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { connection-limit 123 creation-time 2022-08-03:09:51:12 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:51:12 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled service-down-immediate-action reset source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 943 } 9.\u914d\u7f6eVS\u5173\u8054\u591a\u4e2aiRules\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 \u914d\u7f6eVS\u5173\u8054\u591a\u4e2aiRules \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"iRulesTest1\": { \"class\": \"iRule\", \"iRule\": \"when CLIENT_ACCEPTED {\\n \\n }\" }, \"iRulesTest2\": { \"class\": \"iRule\", \"iRule\": \"when CLIENT_ACCEPTED {\\n \\n }\" }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"iRules\": [{ \"use\": \"iRulesTest1\" },{ \"use\": \"iRulesTest2\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:46:05 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:46:05 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } rules { test006/iRulesTest1 test006/iRulesTest2 } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 942 } list ltm rule test006/iRulesTest1 ltm rule test006/iRulesTest1 { partition test006 when CLIENT_ACCEPTED { } } list ltm rule test006/iRulesTest2 ltm rule test006/iRulesTest2 { partition test006 when CLIENT_ACCEPTED { } } 10.\u914d\u7f6e\u591a\u4e2amonitor\u8303\u4f8b \u00b6 \u573a\u666f\u63cf\u8ff0 \u00b6 pool\u4e2d\u914d\u7f6e\u591a\u4e2amonitor \u53c2\u8003yaml \u00b6 kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"monitorTcp1\": { \"class\": \"Monitor\", \"monitorType\": \"tcp\", \"timeout\": 10, \"interval\": 2, \"send\": \"\", \"receive\": \"\" }, \"monitorTcp2\": { \"class\": \"Monitor\", \"monitorType\": \"tcp\", \"timeout\": 7, \"interval\": 2, \"send\": \"\", \"receive\": \"\" }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ { \"use\": \"monitorTcp1\" }, { \"use\": \"monitorTcp2\" } ], \"minimumMonitors\": \"all\", \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"virtualPort\": 82, \"serviceDownImmediateAction\": \"reset\", \"maxConnections\": 123, \"pool\": \"pool3\" } } } } } \u90e8\u7f72\u7ed3\u679c \u00b6 list ltm pool test006/pool3 ltm pool test006/pool3 { min-active-members 1 monitor test006/monitorTcp1 and test006/monitorTcp2 partition test006 } 11.\u5e38\u7528irules\u8303\u4f8b \u00b6 \u6839\u636eURI\u8fdb\u884c\u8f6c\u53d1 \u00b6 \"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if { [HTTP::uri] starts_with \\\"/coffee\\\" } {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else { \\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n \\n}\" }, \u5176\u4e2d if { [HTTP::uri] starts_with \\\"/coffee\\\" } \u8868\u793a\u65b0\u7684\u7248\u672c\u4e2d\u4ee5/coffee\u76ee\u5f55\u5f00\u5934\u7684\u90fd\u4f1a\u5206\u5f80\u65b0\u7248\u672c\u7684\u670d\u52a1\u5668\u4e0a\uff0c {\\n pool k8s-cib001-svc-1-pool-8080 \\n } \u5176\u4e2d\u7684pool\u662f\u65b0\u7248\u672c\u670d\u52a1\u5668\u7684\u5730\u5740\u6c60 \u5982\u679c\u4e0d\u662f\u4ee5/coffee\u5f00\u5934\u7684\u90fd\u4f1a\u5206\u5f80\u65e7\u7248\u672c\u7684\u670d\u52a1\u5668\u4e0a \u6839\u636e\u5ba2\u6237\u7aefip\u8fdb\u884c\u8f6c\u53d1 \u00b6 \"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when CLIENT_ACCEPTED {\\n if {[IP::addr [IP::client_addr] equals 192.168.5.30] or [IP::addr [IP::client_addr] equals 192.168.5.0/24]} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d\u5f53\u7ec8\u7aef\u5730\u5740\u4e3a192.168.5.30\u6216\u8005\u5c5e\u4e8e192.168.5.0/24\u7684\u7f51\u6bb5\uff0c\u8be5\u8bf7\u6c42\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u7684\u60c5\u51b5\u6d41\u91cf\u5747\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c \u6839\u636ecookie\u8fdb\u884c\u8f6c\u53d1 \u00b6 \"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if {[HTTP::cookie exists \\\"Canary\\\"] and [HTTP::cookie value \\\"Canary\\\"] equals \\\"true\\\"} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d\u5982\u679c\u53ef\u4ee5\u5b58\u5728cookie\u4e3aCanary\uff0c\u800c\u4e14\u5bf9\u5e94\u8be5cookie\u503c\u4e3atrue\uff0c\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u7684\u6240\u6709\u6d41\u91cf\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c \u6839\u636ehttp header\u8fdb\u884c\u8f6c\u53d1 \u00b6 \"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if {[HTTP::header exists \\\"Canary\\\"] and [HTTP::header values \\\"Canary\\\"] equals \\\"true\\\"} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2dhttp header\u4e2d\u5982\u679c\u5b58\u5728\\\"Canary\\\"\uff0c\u4e14\u5bf9\u5e94\u7684value\u503c\u4e3atrue\uff0c\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u60c5\u51b5\u6d41\u91cf\u5206\u7ed9 k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c \u6839\u636e\u6bd4\u4f8b\u8fdb\u884c\u7070\u5ea6 \u00b6 \"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when CLIENT_ACCEPTED {\\n if {[expr {[expr {0xffffffff & [crc32 [IP::client_addr]]}] % 100}] < 25} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d< 25 \u662f 25%\u7684\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 75%\u7684\u6d41\u91cf\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c","title":"HTTP\u4e1a\u52a1\u53d1\u5e03"},{"location":"Use-Cases/http/#1http","text":"","title":"1.\u6807\u51c6HTTP\u4e1a\u52a1\u53d1\u5e03\u8303\u4f8b"},{"location":"Use-Cases/http/#_1","text":"\u6807\u51c6HTTP\u4e1a\u52a1\u53d1\u5e03 HTTP\u4e1a\u52a1\u9ed8\u8ba4\u53c2\u6570\u8bf4\u660e\uff1a Snat\u4e3aauto\uff0c\u610f\u601d\u662fautomap persistenceMethods\u4e3acookie\uff0c\u610f\u601d\u9ed8\u8ba4\u4f1a\u8bdd\u4fdd\u6301\u662fcookie VS\u7c7b\u578b\u4e3astandard \u9ed8\u8ba4\u4f1a\u4f7f\u7528http profile","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-11 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vs1\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [ \"172.16.142.181\" ], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_2","text":"list ltm virtual test005/app_svc_vs1 ltm virtual test005/app_svc_vs1 { creation-time 2022-08-02:16:28:32 description test005 destination 172.16.142.181:xfer ip-protocol tcp last-modified-time 2022-08-02:16:28:32 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 933 }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#2virtual-address","text":"","title":"2.\u914d\u7f6evirtual address\u5c5e\u6027\u8303\u4f8b"},{"location":"Use-Cases/http/#_3","text":"\u914d\u7f6evirtual address\u5bf9\u8c61, arp enable no\uff0c virtual server \u5f15\u7528\u8be5\u5bf9\u8c61","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_1","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-2 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.178\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_4","text":"list ltm virtual test005/app_svc_vs2 ltm virtual test005/app_svc_vs2 { creation-time 2022-08-02:16:43:17 description test005 destination 172.16.142.178:xfer ip-protocol tcp last-modified-time 2022-08-02:16:43:17 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 934 } list ltm virtual-address 172.16.142.178 ltm virtual-address 172.16.142.178 { address 172.16.142.178 arp disabled inherited-traffic-group true mask 255.255.255.255 partition test005 traffic-group /Common/traffic-group-1 }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#3tcp-profile","text":"","title":"3.\u914d\u7f6eTCP profile\u8303\u4f8b"},{"location":"Use-Cases/http/#_5","text":"\u914d\u7f6eTCP profile\uff0c\u81ea\u5b9a\u4e49\u8d85\u65f6\u65f6\u95f4","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_2","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-3 namespace: f5-test005 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test005\": { \"class\": \"Tenant\", \"test005\": { \"class\": \"Application\", \"template\": \"generic\", \"customTCPProfile\": { \"class\": \"TCP_Profile\", \"idleTimeout\": 600 }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.178\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip\" }], \"virtualPort\": 82, \"profileTCP\": { \"use\": \"customTCPProfile\" }, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_6","text":"list ltm virtual test005/app_svc_vs2 ltm virtual test005/app_svc_vs2 { creation-time 2022-08-02:17:04:31 description test005 destination 172.16.142.178:xfer ip-protocol tcp last-modified-time 2022-08-02:17:04:31 mask 255.255.255.255 partition test005 persist { /Common/cookie { default yes } } pool test005/pool3 profiles { /Common/http { } test005/customTCPProfile { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 935 } list ltm profile tcp test005/customTCPProfile | grep idle-timeout idle-timeout 600","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#4http-profile","text":"","title":"4.\u914d\u7f6eHTTP profile\u8303\u4f8b"},{"location":"Use-Cases/http/#_7","text":"\u914d\u7f6eHTTP profile\uff0c\u5f00\u542fXFF","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_3","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-4 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"customHTTPProfile\": { \"class\": \"HTTP_Profile\", \"xForwardedFor\": true }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip4\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.188\", \"arpEnabled\": false }, \"app_svc_vs2\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip4\" }], \"virtualPort\": 82, \"profileHTTP\": { \"use\": \"customHTTPProfile\" }, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_8","text":"list ltm virtual test006/app_svc_vs2 ltm virtual test006/app_svc_vs2 { creation-time 2022-08-02:17:57:57 description test006 destination 172.16.142.188:xfer ip-protocol tcp last-modified-time 2022-08-02:17:57:57 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } test006/customHTTPProfile { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 946 } list ltm profile http test006/customHTTPProfile | grep \"insert-xforwarded-for\" insert-xforwarded-for enabled","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#5cookiecookie","text":"","title":"5.\u914d\u7f6ecookie\u4f1a\u8bdd\u4fdd\u6301\uff0ccookie\u52a0\u5bc6\u8303\u4f8b"},{"location":"Use-Cases/http/#_9","text":"\u914d\u7f6ecookie\u4f1a\u8bdd\u4fdd\u6301\uff0c\u5bf9F5 insert\u7684cookie\u8fdb\u884c\u52a0\u5bc6","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_4","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"cookie_encryption\": { \"class\": \"Persist\", \"persistenceMethod\": \"cookie\", \"encrypt\": true, \"cookieMethod\": \"insert\", \"passphrase\": { \"ciphertext\": \"a3RjeGZ5Z2Q=\", \"protected\": \"eyJhbGciOiJkaXIiLCJlbmMiOiJub25lIn0=\" } }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"persistenceMethods\": [{ \"use\": \"cookie_encryption\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_10","text":"list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:31:30 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:31:30 mask 255.255.255.255 partition test006 persist { test006/cookie_encryption { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 939 } list ltm persistence cookie test006/cookie_encryption ltm persistence cookie test006/cookie_encryption { always-send disabled app-service none cookie-encryption required cookie-encryption-passphrase $M$t7$uQ0K+M40jOAbMER6IY+BSA== cookie-name none expiration 0 httponly enabled match-across-pools disabled match-across-services disabled match-across-virtuals disabled method insert mirror disabled override-connection-limit disabled secure enabled timeout indefinite }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#6snat-pool","text":"","title":"6.\u914d\u7f6esnat pool\u8303\u4f8b"},{"location":"Use-Cases/http/#_11","text":"\u914d\u7f6esnat pool\u8303\u4f8b","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_5","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"snatpool-3\": { \"class\": \"SNAT_Pool\", \"snatAddresses\": [ \"172.16.142.21\", \"172.16.142.22\" ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"snat\": { \"use\": \"snatpool-3\" }, \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_12","text":"list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:36:04 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:36:04 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { pool test006/snatpool-3 type snat } translate-address enabled translate-port enabled vs-index 940 } list ltm snatpool test006/snatpool-3 ltm snatpool test006/snatpool-3 { members { 172.16.142.21 172.16.142.22 } partition test006 }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#7one-connect","text":"","title":"7.\u914d\u7f6eone connect\u8303\u4f8b"},{"location":"Use-Cases/http/#_13","text":"\u914d\u7f6eone connect\u8303\u4f8b","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_6","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"customOne\": { \"class\": \"Multiplex_Profile\", \"sourceMask\": \"ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\" }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"profileMultiplex\": { \"use\": \"customOne\" }, \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_14","text":"list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:40:20 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:40:20 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } test006/customOne { } } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 941 } list ltm profile one-connect test006/customOne ltm profile one-connect test006/customOne { app-service none idle-timeout-override disabled limit-type none max-age 86400 max-reuse 1000 max-size 10000 share-pools disabled source-mask ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#8vs-immediate-action-on-svc-down","text":"","title":"8.\u914d\u7f6eVS \u94fe\u63a5\u9650\u5236\uff0c immediate action on svc down\u8303\u4f8b"},{"location":"Use-Cases/http/#_15","text":"\u914d\u7f6eVS \u94fe\u63a5\u9650\u5236\uff0c immediate action on svc down","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_7","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"virtualPort\": 82, \"serviceDownImmediateAction\": \"reset\", \"maxConnections\": 123, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_16","text":"list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { connection-limit 123 creation-time 2022-08-03:09:51:12 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:51:12 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } serverssl-use-sni disabled service-down-immediate-action reset source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 943 }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#9vsirules","text":"","title":"9.\u914d\u7f6eVS\u5173\u8054\u591a\u4e2aiRules\u8303\u4f8b"},{"location":"Use-Cases/http/#_17","text":"\u914d\u7f6eVS\u5173\u8054\u591a\u4e2aiRules","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_8","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"pool3\": { \"class\": \"Pool\", \"monitors\": [ \"tcp\" ], \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"iRulesTest1\": { \"class\": \"iRule\", \"iRule\": \"when CLIENT_ACCEPTED {\\n \\n }\" }, \"iRulesTest2\": { \"class\": \"iRule\", \"iRule\": \"when CLIENT_ACCEPTED {\\n \\n }\" }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"iRules\": [{ \"use\": \"iRulesTest1\" },{ \"use\": \"iRulesTest2\" }], \"virtualPort\": 82, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_18","text":"list ltm virtual test006/app_svc_vs6 ltm virtual test006/app_svc_vs6 { creation-time 2022-08-03:09:46:05 description test006 destination 172.16.142.186:xfer ip-protocol tcp last-modified-time 2022-08-03:09:46:05 mask 255.255.255.255 partition test006 persist { /Common/cookie { default yes } } pool test006/pool3 profiles { /Common/f5-tcp-progressive { } /Common/http { } } rules { test006/iRulesTest1 test006/iRulesTest2 } serverssl-use-sni disabled source 0.0.0.0/0 source-address-translation { type automap } translate-address enabled translate-port enabled vs-index 942 } list ltm rule test006/iRulesTest1 ltm rule test006/iRulesTest1 { partition test006 when CLIENT_ACCEPTED { } } list ltm rule test006/iRulesTest2 ltm rule test006/iRulesTest2 { partition test006 when CLIENT_ACCEPTED { } }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#10monitor","text":"","title":"10.\u914d\u7f6e\u591a\u4e2amonitor\u8303\u4f8b"},{"location":"Use-Cases/http/#_19","text":"pool\u4e2d\u914d\u7f6e\u591a\u4e2amonitor","title":"\u573a\u666f\u63cf\u8ff0"},{"location":"Use-Cases/http/#yaml_9","text":"kind: ConfigMap apiVersion: v1 metadata: name: app-as3-6 namespace: f5-test006 labels: f5type: virtual-server as3: \"true\" data: template: | { \"class\": \"AS3\", \"action\": \"deploy\", \"persist\": true, \"declaration\": { \"class\": \"ADC\", \"schemaVersion\": \"3.28.0\", \"remark\": \"HTTP application\", \"test006\": { \"class\": \"Tenant\", \"test006\": { \"class\": \"Application\", \"template\": \"generic\", \"monitorTcp1\": { \"class\": \"Monitor\", \"monitorType\": \"tcp\", \"timeout\": 10, \"interval\": 2, \"send\": \"\", \"receive\": \"\" }, \"monitorTcp2\": { \"class\": \"Monitor\", \"monitorType\": \"tcp\", \"timeout\": 7, \"interval\": 2, \"send\": \"\", \"receive\": \"\" }, \"pool3\": { \"class\": \"Pool\", \"monitors\": [ { \"use\": \"monitorTcp1\" }, { \"use\": \"monitorTcp2\" } ], \"minimumMonitors\": \"all\", \"members\": [ { \"servicePort\": 8080, \"serverAddresses\": [ ] } ] }, \"app_svc_vip6\": { \"class\": \"Service_Address\", \"virtualAddress\": \"172.16.142.186\", \"arpEnabled\": false }, \"app_svc_vs6\": { \"class\": \"Service_HTTP\", \"virtualAddresses\": [{ \"use\": \"app_svc_vip6\" }], \"virtualPort\": 82, \"serviceDownImmediateAction\": \"reset\", \"maxConnections\": 123, \"pool\": \"pool3\" } } } } }","title":"\u53c2\u8003yaml"},{"location":"Use-Cases/http/#_20","text":"list ltm pool test006/pool3 ltm pool test006/pool3 { min-active-members 1 monitor test006/monitorTcp1 and test006/monitorTcp2 partition test006 }","title":"\u90e8\u7f72\u7ed3\u679c"},{"location":"Use-Cases/http/#11irules","text":"","title":"11.\u5e38\u7528irules\u8303\u4f8b"},{"location":"Use-Cases/http/#uri","text":"\"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if { [HTTP::uri] starts_with \\\"/coffee\\\" } {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else { \\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n \\n}\" }, \u5176\u4e2d if { [HTTP::uri] starts_with \\\"/coffee\\\" } \u8868\u793a\u65b0\u7684\u7248\u672c\u4e2d\u4ee5/coffee\u76ee\u5f55\u5f00\u5934\u7684\u90fd\u4f1a\u5206\u5f80\u65b0\u7248\u672c\u7684\u670d\u52a1\u5668\u4e0a\uff0c {\\n pool k8s-cib001-svc-1-pool-8080 \\n } \u5176\u4e2d\u7684pool\u662f\u65b0\u7248\u672c\u670d\u52a1\u5668\u7684\u5730\u5740\u6c60 \u5982\u679c\u4e0d\u662f\u4ee5/coffee\u5f00\u5934\u7684\u90fd\u4f1a\u5206\u5f80\u65e7\u7248\u672c\u7684\u670d\u52a1\u5668\u4e0a","title":"\u6839\u636eURI\u8fdb\u884c\u8f6c\u53d1"},{"location":"Use-Cases/http/#ip","text":"\"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when CLIENT_ACCEPTED {\\n if {[IP::addr [IP::client_addr] equals 192.168.5.30] or [IP::addr [IP::client_addr] equals 192.168.5.0/24]} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d\u5f53\u7ec8\u7aef\u5730\u5740\u4e3a192.168.5.30\u6216\u8005\u5c5e\u4e8e192.168.5.0/24\u7684\u7f51\u6bb5\uff0c\u8be5\u8bf7\u6c42\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u7684\u60c5\u51b5\u6d41\u91cf\u5747\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c","title":"\u6839\u636e\u5ba2\u6237\u7aefip\u8fdb\u884c\u8f6c\u53d1"},{"location":"Use-Cases/http/#cookie","text":"\"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if {[HTTP::cookie exists \\\"Canary\\\"] and [HTTP::cookie value \\\"Canary\\\"] equals \\\"true\\\"} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d\u5982\u679c\u53ef\u4ee5\u5b58\u5728cookie\u4e3aCanary\uff0c\u800c\u4e14\u5bf9\u5e94\u8be5cookie\u503c\u4e3atrue\uff0c\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u7684\u6240\u6709\u6d41\u91cf\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c","title":"\u6839\u636ecookie\u8fdb\u884c\u8f6c\u53d1"},{"location":"Use-Cases/http/#http-header","text":"\"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when HTTP_REQUEST {\\n if {[HTTP::header exists \\\"Canary\\\"] and [HTTP::header values \\\"Canary\\\"] equals \\\"true\\\"} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2dhttp header\u4e2d\u5982\u679c\u5b58\u5728\\\"Canary\\\"\uff0c\u4e14\u5bf9\u5e94\u7684value\u503c\u4e3atrue\uff0c\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 \u5176\u5b83\u60c5\u51b5\u6d41\u91cf\u5206\u7ed9 k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c","title":"\u6839\u636ehttp header\u8fdb\u884c\u8f6c\u53d1"},{"location":"Use-Cases/http/#_21","text":"\"irule_k8s-cib001-svc-1\": { \"class\": \"iRule\", \"remark\": \"switch between pools\", \"iRule\": \"when CLIENT_ACCEPTED {\\n if {[expr {[expr {0xffffffff & [crc32 [IP::client_addr]]}] % 100}] < 25} {\\n pool k8s-cib001-svc-1-pool-8080 \\n } else {\\n pool k8s-cib001-app-svc-4-pool-8080 \\n }\\n}\" }, \u5176\u4e2d< 25 \u662f 25%\u7684\u6d41\u91cf\u5206\u7ed9 pool k8s-cib001-svc-1-pool-8080 75%\u7684\u6d41\u91cf\u5206\u5f80 pool k8s-cib001-app-svc-1-pool-8080 \u6ce8\u610f\u4e00\u4e0b\u5982\u4e0airule\u7684\u5199\u6cd5\uff0c \\n \u8868\u793a\u6362\u884c","title":"\u6839\u636e\u6bd4\u4f8b\u8fdb\u884c\u7070\u5ea6"},{"location":"Use-Cases/https/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"HTTPS\u4e1a\u52a1\u53d1\u5e03"},{"location":"Use-Cases/https/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/hub/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"Hub\u6a21\u5f0f\u53d1\u5e03"},{"location":"Use-Cases/hub/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/ipv6/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"IPV6\u53d1\u5e03"},{"location":"Use-Cases/ipv6/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/l4/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"L4\u6a21\u5f0f\u53d1\u5e03"},{"location":"Use-Cases/l4/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/tcp/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"TCP(proxy)\u4e1a\u52a1\u53d1\u5e03"},{"location":"Use-Cases/tcp/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"Use-Cases/udp/","text":"\u4e3b\u9875 \u00b6 \u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"UDP(proxy)\u4e1a\u52a1\u53d1\u5e03"},{"location":"Use-Cases/udp/#_1","text":"\u6b22\u8fce\u4f7f\u7528CIS-C\u3002 \u5185\u5bb9\u5f88\u5feb\u8865\u5145\u5b8c\u6bd5","title":"\u4e3b\u9875"},{"location":"quick-start/","text":"\u51c6\u5907\u5de5\u4f5c \u00b6 1. BIG-IP \u8bbe\u5907 (\u4ee5\u4e0bvxlan\u76f8\u5173\u6b65\u9aa4\u4ec5\u9488\u5bf9flannel\u6a21\u5f0f\u3002\u5982\u679c\u4e3acalico\u7b49underlay\u6a21\u5f0f\uff0c\u5219\u4e0d\u9700\u8981\u8be5\u6b65\u9aa4) \u00b6 \u521b\u5efaVXLAN create net tunnels vxlan /Common/fl-vxlan { app-service none flooding-type none port 8472 } \u521b\u5efaVXLAN Tunnel \u53caVTEP IP create net tunnels tunnel /Common/fl-tunnel { key 1 local-address 10.250.16.127 profile /Common/fl-vxlan } \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645traffic \u63a5\u53e3IP\u66ff\u6362 10.250.16.127 \u521b\u5efaVXLAN Tunnel SelfIP create net self /Common/fl-vxlan-selfip { address 10.42.20.1/16 allow-service all traffic-group /Common/traffic-group-local-only vlan /Common/fl-tunnel } \u6ce8\u610f\u8fd9\u91cc\u768410.42.20.1/16\u7684\u524d\u4e24\u4f4d\u901a\u8fc7\u6307\u4ee4 kubectl get node -o yaml | grep podCIDR \u83b7\u53d6\uff0c\u7b2c3\u4f4d\u4efb\u9009\u6570\u503c\u4e0d\u4e0e\u5df2\u6709node\u91cd\u590d\u5373\u53ef\u3002 \u521b\u5efa\u672c\u5730VLAN\u53caSelfIP create net vlan /Common/vlan-traffic { interfaces { 1.1 { } } sflow { poll-interval-global no sampling-rate-global no } tag 4094 } create net self /Common/vlan-traffic { address 10.250.16.127/24 traffic-group /Common/traffic-group-local-only vlan /Common/vlan-traffic } \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645traffic \u63a5\u53e3IP\u66ff\u6362 10.250.16.127 2. Kubernetes \u00b6 \u521b\u5efaserviceaccount kubectl create serviceaccount k8s-bigip-ctlr -n kube-system \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a apiVersion: v1 kind: ServiceAccount metadata: name: k8s-bigip-ctlr namespace: kube-system \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165service-account.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f service-account.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efaBIG-IP\u767b\u9646\u5bc6\u7801 (\u89c6\u9700\u8981\u4fee\u6539\u7528\u6237\u540d,\u5bc6\u7801\u4ee5\u53caURL\u7b49) kubectl create secret generic bigip-login -n kube-system --from-literal=username=admin --from-literal=password=mypassword --from-literal=url=https://10.10.10.10:443 \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645url\u53ca\u5bc6\u7801\u66ff\u6362\u793a\u4f8b\u4e2d\u7684https://10.10.10.10:443\u53camypassword \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a --- apiVersion: v1 kind: Secret metadata: name: bigip-login namespace: kube-system data: url: aHR0cHM6Ly8xMC4xMC4xMC4xMDo0NDM= # base64 encoded 'https://10.10.10.10:443' username: YWRtaW4= # base64 encoded 'admin' password: bXlwYXNzd29yZA== # base64 encoded 'mypassword' type: Opaque base64 \u7f16\u7801\u6307\u4ee4\u4e3a echo -n xxxxx | base64 \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165secret.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f secret.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efarolebinding kubectl create clusterrolebinding k8s-bigip-ctlr-clusteradmin --clusterrole=cluster-admin --serviceaccount=kube-system:k8s-bigip-ctlr \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: k8s-bigip-ctlr-clusteradmin roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: k8s-bigip-ctlr namespace: kube-system \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165role-binding.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f role-binding.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efaBIG-IP\u865a\u62df\u8282\u70b9(\u4ec5\u5728flannel\u6a21\u5f0f\u4e0b\u9700\u8981\u672c\u6b65\u9aa4) \u521b\u5efabigip1 \u865a\u62df\u8282\u70b9\uff0c\u6253\u901aBIG-IP\u8282\u70b9\u5230k8s\u7684vxlan\u7f51\u7edc\u3002 \u4f7f\u7528\u4ee5\u4e0byaml\u914d\u7f6e\u6587\u4ef6bigip_node.yaml\uff1a apiVersion: v1 kind: Node metadata: name: bigip1 annotations: #Replace IP with Self-IP for your deployment flannel.alpha.coreos.com/public-ip: \"10.250.18.105\" #Replace MAC with your BIGIP Flannel VXLAN Tunnel MAC flannel.alpha.coreos.com/backend-data: '{\"VtepMAC\":\"fa:16:3e:d5:28:07\"}' flannel.alpha.coreos.com/backend-type: \"vxlan\" flannel.alpha.coreos.com/kube-subnet-manager: \"true\" spec: #Replace Subnet with your BIGIP Flannel Subnet podCIDR: \"10.42.20.0/24\" \u5176\u4e2d fa:16:3e:d5:28:07 \u53ef\u4ee5\u5728BIG-IP\u4e0a\u4f7f\u7528\u6b64\u547d\u4ee4\u83b7\u53d6\uff1a show net tunnels tunnel fl-tunnel all-properties \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165bigip1.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f bigip1.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 3. Prometheus \u76d1\u63a7\uff08\u53ef\u9009\uff09 \u00b6 F5 CIS-C \u7a0b\u5e8f\u5f00\u542f\u4e868080\u7aef\u53e3\u7528\u4e8ePrometheus\u6536\u96c6metrics # expose the Prometheus port with NodePort apiVersion: v1 kind: Service metadata: name: k8s-bigip-ctlr-c-svc namespace: kube-system spec: selector: app: k8s-bigip-ctlr-c-pod ports: - name: k8s-bigip-ctlr-c-metrics protocol: TCP port: 8080 targetPort: 8080 nodePort: 30080 \u6240\u4ee5\uff0c\u5728Prometheus\u670d\u52a1\u5668\u7aef\uff0c\u9700\u8981\u5728\u914d\u7f6e\u4e2d\u6dfb\u52a0\u914d\u7f6e\u9879\uff1a - job_name: \"f5-cis-c\" static_configs: - targets: [\"10.250.18.102:30080\"] \u5176\u4e2d 10.250.18.102 \u4e3aF5 CIS-C\u7a0b\u5e8f\u6240\u5728Node\u7684IP\u3002","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"quick-start/#_1","text":"","title":"\u51c6\u5907\u5de5\u4f5c"},{"location":"quick-start/#1-big-ip-vxlanflannelcalicounderlay","text":"\u521b\u5efaVXLAN create net tunnels vxlan /Common/fl-vxlan { app-service none flooding-type none port 8472 } \u521b\u5efaVXLAN Tunnel \u53caVTEP IP create net tunnels tunnel /Common/fl-tunnel { key 1 local-address 10.250.16.127 profile /Common/fl-vxlan } \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645traffic \u63a5\u53e3IP\u66ff\u6362 10.250.16.127 \u521b\u5efaVXLAN Tunnel SelfIP create net self /Common/fl-vxlan-selfip { address 10.42.20.1/16 allow-service all traffic-group /Common/traffic-group-local-only vlan /Common/fl-tunnel } \u6ce8\u610f\u8fd9\u91cc\u768410.42.20.1/16\u7684\u524d\u4e24\u4f4d\u901a\u8fc7\u6307\u4ee4 kubectl get node -o yaml | grep podCIDR \u83b7\u53d6\uff0c\u7b2c3\u4f4d\u4efb\u9009\u6570\u503c\u4e0d\u4e0e\u5df2\u6709node\u91cd\u590d\u5373\u53ef\u3002 \u521b\u5efa\u672c\u5730VLAN\u53caSelfIP create net vlan /Common/vlan-traffic { interfaces { 1.1 { } } sflow { poll-interval-global no sampling-rate-global no } tag 4094 } create net self /Common/vlan-traffic { address 10.250.16.127/24 traffic-group /Common/traffic-group-local-only vlan /Common/vlan-traffic } \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645traffic \u63a5\u53e3IP\u66ff\u6362 10.250.16.127","title":"1. BIG-IP \u8bbe\u5907 (\u4ee5\u4e0bvxlan\u76f8\u5173\u6b65\u9aa4\u4ec5\u9488\u5bf9flannel\u6a21\u5f0f\u3002\u5982\u679c\u4e3acalico\u7b49underlay\u6a21\u5f0f\uff0c\u5219\u4e0d\u9700\u8981\u8be5\u6b65\u9aa4)"},{"location":"quick-start/#2-kubernetes","text":"\u521b\u5efaserviceaccount kubectl create serviceaccount k8s-bigip-ctlr -n kube-system \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a apiVersion: v1 kind: ServiceAccount metadata: name: k8s-bigip-ctlr namespace: kube-system \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165service-account.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f service-account.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efaBIG-IP\u767b\u9646\u5bc6\u7801 (\u89c6\u9700\u8981\u4fee\u6539\u7528\u6237\u540d,\u5bc6\u7801\u4ee5\u53caURL\u7b49) kubectl create secret generic bigip-login -n kube-system --from-literal=username=admin --from-literal=password=mypassword --from-literal=url=https://10.10.10.10:443 \u6ce8\u610f\uff1a \u4f7f\u7528BIG-IP\u5b9e\u9645url\u53ca\u5bc6\u7801\u66ff\u6362\u793a\u4f8b\u4e2d\u7684https://10.10.10.10:443\u53camypassword \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a --- apiVersion: v1 kind: Secret metadata: name: bigip-login namespace: kube-system data: url: aHR0cHM6Ly8xMC4xMC4xMC4xMDo0NDM= # base64 encoded 'https://10.10.10.10:443' username: YWRtaW4= # base64 encoded 'admin' password: bXlwYXNzd29yZA== # base64 encoded 'mypassword' type: Opaque base64 \u7f16\u7801\u6307\u4ee4\u4e3a echo -n xxxxx | base64 \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165secret.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f secret.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efarolebinding kubectl create clusterrolebinding k8s-bigip-ctlr-clusteradmin --clusterrole=cluster-admin --serviceaccount=kube-system:k8s-bigip-ctlr \u6216\u8005\u4f7f\u7528\u4ee5\u4e0byaml\u521b\u5efa\uff1a apiVersion: rbac.authorization.k8s.io/v1 kind: ClusterRoleBinding metadata: name: k8s-bigip-ctlr-clusteradmin roleRef: apiGroup: rbac.authorization.k8s.io kind: ClusterRole name: cluster-admin subjects: - kind: ServiceAccount name: k8s-bigip-ctlr namespace: kube-system \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165role-binding.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f role-binding.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002 \u521b\u5efaBIG-IP\u865a\u62df\u8282\u70b9(\u4ec5\u5728flannel\u6a21\u5f0f\u4e0b\u9700\u8981\u672c\u6b65\u9aa4) \u521b\u5efabigip1 \u865a\u62df\u8282\u70b9\uff0c\u6253\u901aBIG-IP\u8282\u70b9\u5230k8s\u7684vxlan\u7f51\u7edc\u3002 \u4f7f\u7528\u4ee5\u4e0byaml\u914d\u7f6e\u6587\u4ef6bigip_node.yaml\uff1a apiVersion: v1 kind: Node metadata: name: bigip1 annotations: #Replace IP with Self-IP for your deployment flannel.alpha.coreos.com/public-ip: \"10.250.18.105\" #Replace MAC with your BIGIP Flannel VXLAN Tunnel MAC flannel.alpha.coreos.com/backend-data: '{\"VtepMAC\":\"fa:16:3e:d5:28:07\"}' flannel.alpha.coreos.com/backend-type: \"vxlan\" flannel.alpha.coreos.com/kube-subnet-manager: \"true\" spec: #Replace Subnet with your BIGIP Flannel Subnet podCIDR: \"10.42.20.0/24\" \u5176\u4e2d fa:16:3e:d5:28:07 \u53ef\u4ee5\u5728BIG-IP\u4e0a\u4f7f\u7528\u6b64\u547d\u4ee4\u83b7\u53d6\uff1a show net tunnels tunnel fl-tunnel all-properties \u5c06\u4ee5\u4e0a\u5185\u5bb9\u653e\u5165bigip1.yaml\u6587\u4ef6\u4e2d, \u4f7f\u7528 kubectl apply -f bigip1.yaml \u547d\u4ee4\u6267\u884c\u6587\u4ef6\u5185\u5bb9\u3002","title":"2. Kubernetes"},{"location":"quick-start/#3-prometheus","text":"F5 CIS-C \u7a0b\u5e8f\u5f00\u542f\u4e868080\u7aef\u53e3\u7528\u4e8ePrometheus\u6536\u96c6metrics # expose the Prometheus port with NodePort apiVersion: v1 kind: Service metadata: name: k8s-bigip-ctlr-c-svc namespace: kube-system spec: selector: app: k8s-bigip-ctlr-c-pod ports: - name: k8s-bigip-ctlr-c-metrics protocol: TCP port: 8080 targetPort: 8080 nodePort: 30080 \u6240\u4ee5\uff0c\u5728Prometheus\u670d\u52a1\u5668\u7aef\uff0c\u9700\u8981\u5728\u914d\u7f6e\u4e2d\u6dfb\u52a0\u914d\u7f6e\u9879\uff1a - job_name: \"f5-cis-c\" static_configs: - targets: [\"10.250.18.102:30080\"] \u5176\u4e2d 10.250.18.102 \u4e3aF5 CIS-C\u7a0b\u5e8f\u6240\u5728Node\u7684IP\u3002","title":"3. Prometheus \u76d1\u63a7\uff08\u53ef\u9009\uff09"},{"location":"quick-start/installation/","text":"\u4e0b\u8f7d\u4e0e\u5b89\u88c5 \u00b6 \u5b89\u88c5F5 CIS-C\u3002 \u53c2\u8003\u4e0b\u8ff0yaml\u6587\u4ef6\u3002\u6309\u9700\u6c42\u8c03\u6574image\u7248\u672c\u7b49\u53c2\u6570\u4fe1\u606f\uff08\u8be6\u60c5\u53c2\u8003 \u542f\u52a8\u53c2\u6570\u5217\u8868 \uff09\u3002kubectl create -f my-deployment.yaml\u3002 apiVersion: apps/v1 kind: Deployment metadata: name: k8s-bigip-ctlr-c namespace: kube-system spec: replicas: 1 selector: matchLabels: app: k8s-bigip-ctlr-c-pod template: metadata: name: k8s-bigip-ctlr-c-pod labels: app: k8s-bigip-ctlr-c-pod spec: serviceAccountName: k8s-bigip-ctlr containers: - name: k8s-bigip-ctlr-c-pod image: \"f5devcentral/k8s-bigip-ctlr-c:2.9.1-20220804\" imagePullPolicy: IfNotPresent env: - name: BIGIP_USERNAME valueFrom: secretKeyRef: name: bigip-login key: username - name: BIGIP_PASSWORD valueFrom: secretKeyRef: name: bigip-login key: password - name: BIGIP_URL valueFrom: secretKeyRef: name: bigip-login key: url command: [\"/f5-kic-linux\"] args: [ \"--bigip-username=$(BIGIP_USERNAME)\", \"--bigip-password=$(BIGIP_PASSWORD)\", \"--bigip-url=$(BIGIP_URL)\", \"--log-level=debug\", # if flannel-name is set, meanning trying to use flannel mode # and customer needs to create related tunnel on BIGIP first. # \"--flannel-name=fl-tunnel\", # \"--namespace=default\", # \"--namespace=namespace-1\", # \"--namespace-label=resource.zone=deployment\", \"--hub-mode\", \"--ignore-service-port\" ] - name: as3-parser image: \"f5devcentral/cis-c-as3-parser:latest\" imagePullPolicy: IfNotPresent ports: - containerPort: 8081 protocol: TCP --- # the following service is optional. # expose the Prometheus port with NodePort apiVersion: v1 kind: Service metadata: name: k8s-bigip-ctlr-c-svc namespace: kube-system spec: selector: app: k8s-bigip-ctlr-c-pod ports: - name: k8s-bigip-ctlr-c-metrics protocol: TCP port: 8080 targetPort: 8080 nodePort: 30080 - name: k8s-bigip-ctlr-c-debug-dumps protocol: TCP port: 8082 targetPort: 8082 nodePort: 30082 type: NodePort","title":"\u4e0b\u8f7d\u4e0e\u5b89\u88c5"},{"location":"quick-start/installation/#_1","text":"\u5b89\u88c5F5 CIS-C\u3002 \u53c2\u8003\u4e0b\u8ff0yaml\u6587\u4ef6\u3002\u6309\u9700\u6c42\u8c03\u6574image\u7248\u672c\u7b49\u53c2\u6570\u4fe1\u606f\uff08\u8be6\u60c5\u53c2\u8003 \u542f\u52a8\u53c2\u6570\u5217\u8868 \uff09\u3002kubectl create -f my-deployment.yaml\u3002 apiVersion: apps/v1 kind: Deployment metadata: name: k8s-bigip-ctlr-c namespace: kube-system spec: replicas: 1 selector: matchLabels: app: k8s-bigip-ctlr-c-pod template: metadata: name: k8s-bigip-ctlr-c-pod labels: app: k8s-bigip-ctlr-c-pod spec: serviceAccountName: k8s-bigip-ctlr containers: - name: k8s-bigip-ctlr-c-pod image: \"f5devcentral/k8s-bigip-ctlr-c:2.9.1-20220804\" imagePullPolicy: IfNotPresent env: - name: BIGIP_USERNAME valueFrom: secretKeyRef: name: bigip-login key: username - name: BIGIP_PASSWORD valueFrom: secretKeyRef: name: bigip-login key: password - name: BIGIP_URL valueFrom: secretKeyRef: name: bigip-login key: url command: [\"/f5-kic-linux\"] args: [ \"--bigip-username=$(BIGIP_USERNAME)\", \"--bigip-password=$(BIGIP_PASSWORD)\", \"--bigip-url=$(BIGIP_URL)\", \"--log-level=debug\", # if flannel-name is set, meanning trying to use flannel mode # and customer needs to create related tunnel on BIGIP first. # \"--flannel-name=fl-tunnel\", # \"--namespace=default\", # \"--namespace=namespace-1\", # \"--namespace-label=resource.zone=deployment\", \"--hub-mode\", \"--ignore-service-port\" ] - name: as3-parser image: \"f5devcentral/cis-c-as3-parser:latest\" imagePullPolicy: IfNotPresent ports: - containerPort: 8081 protocol: TCP --- # the following service is optional. # expose the Prometheus port with NodePort apiVersion: v1 kind: Service metadata: name: k8s-bigip-ctlr-c-svc namespace: kube-system spec: selector: app: k8s-bigip-ctlr-c-pod ports: - name: k8s-bigip-ctlr-c-metrics protocol: TCP port: 8080 targetPort: 8080 nodePort: 30080 - name: k8s-bigip-ctlr-c-debug-dumps protocol: TCP port: 8082 targetPort: 8082 nodePort: 30082 type: NodePort","title":"\u4e0b\u8f7d\u4e0e\u5b89\u88c5"},{"location":"quick-start/prometheus/","text":"Prometheus\u96c6\u6210 \u00b6 TODO:\u63cf\u8ff0metrics\u8f93\u51fa\uff0c\u53ca\u4f5c\u7528","title":"Prometheus\u96c6\u6210"},{"location":"quick-start/prometheus/#prometheus","text":"TODO:\u63cf\u8ff0metrics\u8f93\u51fa\uff0c\u53ca\u4f5c\u7528","title":"Prometheus\u96c6\u6210"},{"location":"quick-start/uninstall/","text":"\u5378\u8f7d \u00b6 \u5982\u679c\u90e8\u7f72\u65f6 CIS-C deployment \u7684\u540d\u79f0\u4e3a k8s-bigip-ctlr-c\uff0c\u4e14\u5c5e\u4e8ekube-system \u547d\u540d\u7a7a\u95f4\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u5982\u4e0b\u547d\u4ee4\u5220\u9664 CIS-C deployment\u3002 kubectl delete deployments.apps -n kube-system k8s-bigip-ctlr-c \u8bf7\u8c28\u614e\u505a\u5220\u9664\u7684\u64cd\u4f5c\u3002","title":"\u5378\u8f7d"},{"location":"quick-start/uninstall/#_1","text":"\u5982\u679c\u90e8\u7f72\u65f6 CIS-C deployment \u7684\u540d\u79f0\u4e3a k8s-bigip-ctlr-c\uff0c\u4e14\u5c5e\u4e8ekube-system \u547d\u540d\u7a7a\u95f4\uff0c\u5219\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u5982\u4e0b\u547d\u4ee4\u5220\u9664 CIS-C deployment\u3002 kubectl delete deployments.apps -n kube-system k8s-bigip-ctlr-c \u8bf7\u8c28\u614e\u505a\u5220\u9664\u7684\u64cd\u4f5c\u3002","title":"\u5378\u8f7d"}]}